{% extends "base.html" %}

{% block scripts %}
    <script>
     delete_rsvp = function(event_id, rsvp_id){
         fetch(`/api/rsvps/${event_id}/${rsvp_id}`, {method: "DELETE"}).then(function(response){
             console.log(response);
             if (response.status == 200){
                 window.location.href = "";
             } else {
                 alert("Failed to delete RSVP!");
             }
         });

     }

     update_message = function(){
         if ($('#name').val() !== "") {
             $(".alert").text('RSVPing...').show();
         }
     }
    </script>
{% endblock %}

{% block content %}
    <form action="/new/{{event._id}}" method='POST'>
        <div  class="form-group">
            <label for="name">Name:</label>
            <input  type="text" name="name"  id="name" placeholder="Enter name" required>
        </div>
        <button type="Submit" onclick="update_message()" align="center" name="submit" class="btn btn-danger">Submit</button>
    </form>
    <h3> RSVP Count : {{counter}} </h3>
    <ol>
        {% for item in items %}
            <li class="text-center" style="line-height: 3em;">
                <span>{{ item.name }}</span>
                <button style="float: none !important"
                        onclick='delete_rsvp("{{event._id}}","{{item._id}}")'
                        class="close">
                    x
                </button>
            </li>
        {% endfor %}
    </ol>
    <p class="alert alert-info" style="display: none;"></p>
{% endblock %}
